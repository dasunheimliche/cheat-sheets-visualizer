---
title: "2.06 - Path Parameters y Validaciones Num√©ricas en FastAPI"
description: "Domina la validaci√≥n de par√°metros de ruta, el orden de argumentos y las restricciones num√©ricas."
tags: ["fastapi", "python", "validation", "path parameters"]
prompt-version: cheat-sheet-generator-1.1
---

## A - `Path`: El Portero de tu Ruta [üî¥]

#### 1. **Introducci√≥n:**

`Path` es la herramienta que usas para decirle a FastAPI que un valor **dentro de la URL** (como un ID) necesita reglas, validaciones o documentaci√≥n extra.

#### 2. **Ejemplo:**

```python
from typing import Annotated
from fastapi import FastAPI, Path

app = FastAPI()

@app.get("/items/{item_id}")
async def read_items(
    # Le decimos: item_id es un entero, viene del Path, y este es su t√≠tulo.
    item_id: Annotated[int, Path(title="El ID del item a obtener")]
):
    return {"item_id": item_id}
```

#### 3. **Desarrollo:**

Al igual que usas `Query` para los par√°metros de consulta (los que van despu√©s del `?` en la URL), usas `Path` para los que forman parte de la direcci√≥n misma (ej: `/items/5`).

**¬øPor qu√© usarlo?**
Si solo escribes `item_id: int`, FastAPI ya sabe que es un par√°metro de ruta. Pero si quieres agregar un t√≠tulo para la documentaci√≥n autom√°tica, o validar que el n√∫mero sea mayor a 10, **necesitas** envolverlo en `Path`.

üî¥ **Fundamental**: Es la base para controlar qu√© datos entran por la URL de tu API. Sin esto, no puedes poner reglas estrictas a tus rutas.

---

## B - La Regla de "Siempre Requerido" [üü°]

#### 1. **Introducci√≥n:**

Un par√°metro de ruta (`Path Parameter`) **jam√°s** puede ser opcional, incluso si intentas decirle a Python lo contrario.

#### 2. **Ejemplo:**

```python
# AUNQUE pongas "= None", FastAPI te obligar√° a pasar el item_id
@app.get("/items/{item_id}")
async def read_items(
    item_id: int = Path(default=None) # ‚ö†Ô∏è Esto no lo hace opcional
):
    return {"item_id": item_id}
```

#### 3. **Desarrollo:**

Pi√©nsalo un segundo: si tu ruta es `/items/{item_id}`, y el usuario llama a `/items/`, ¬°esa es una ruta diferente! No es la misma ruta con el par√°metro vac√≠o. Por eso, el par√°metro de ruta **siempre** tiene que existir para que la URL coincida.

**La Trampa:**
A veces los programadores intentan poner `default=None` pensando que as√≠ el usuario puede omitir el ID. No funciona as√≠. Si es parte de la ruta, es obligatorio. Punto.

üü° **Importante**: Entender esto te ahorrar√° horas intentando hacer "opcional" algo que por definici√≥n de HTTP no puede serlo en esa estructura de URL.

---

## C - El Problema del Orden (Python vs. FastAPI) [üîµ]

#### 1. **Introducci√≥n:**

Python explota si pones un par√°metro con valor por defecto _antes_ de uno que no lo tiene, pero FastAPI te ofrece formas de evitar este dolor de cabeza.

#### 2. **Ejemplo:**

```python
# ‚ùå ERROR DE PYTHON:
# "SyntaxError: non-default argument follows default argument"
# Esto falla porque 'item_id' tiene un valor por defecto (= Path(...)) y 'q' no.
async def read_items(item_id: int = Path(title="ID"), q: str):
    pass

# ‚úÖ SOLUCI√ìN 1: Reordenar (Poner primero el que no tiene default)
async def read_items(q: str, item_id: int = Path(title="ID")):
    pass
```

#### 3. **Desarrollo:**

Aqu√≠ es donde entra mi paranoia de pedagogo: **FastAPI no le importa el orden**, √©l busca los par√°metros por nombre. Pero a **Python s√≠ le importa**.

Si usas la forma antigua (`item_id: int = Path(...)`), Python ve ese `= Path(...)` como un valor por defecto. Si luego pones `q: str` (que no tiene valor por defecto), Python te gritar√°.

**¬øC√≥mo lo solucionamos?**
Tienes dos opciones principales:

1.  **Reordenar:** Pon primero los par√°metros que no tienen `= ...`.
2.  **Usar `Annotated` (Ver concepto D):** La soluci√≥n moderna y recomendada.

üîµ **Espec√≠fico**: Es un problema puramente de sintaxis de Python, no de l√≥gica de FastAPI, pero te topar√°s con √©l si no usas `Annotated`.

---

## D - `Annotated`: La Soluci√≥n Elegante al Orden [üî¥]

#### 1. **Introducci√≥n:**

Usar `Annotated` elimina el problema del orden porque mueves la configuraci√≥n de `Path` al "tipo" del dato, dejando el valor por defecto libre.

#### 2. **Ejemplo:**

```python
from typing import Annotated

# ‚úÖ Con Annotated, el orden NO importa.
# Python no ve un valor por defecto en item_id, solo ve informaci√≥n de tipo.
async def read_items(
    item_id: Annotated[int, Path(title="ID")],
    q: str
):
    return {"item_id": item_id, "q": q}
```

#### 3. **Desarrollo:**

**Comparativa Cr√≠tica: Annotated vs. Estilo Cl√°sico**

| Caracter√≠stica        | Estilo Cl√°sico (`= Path(...)`)               | Estilo `Annotated`                                    |
| :-------------------- | :------------------------------------------- | :---------------------------------------------------- |
| **Sintaxis**          | `val: int = Path(...)`                       | `val: Annotated[int, Path(...)]`                      |
| **Problema de Orden** | **S√≠**. Python se queja si mezclas defaults. | **No**. No usas el `=` de Python para definir `Path`. |
| **Recomendaci√≥n**     | Versiones viejas de Python/FastAPI.          | **Est√°ndar actual y recomendado.**                    |

**¬øPor qu√© elegir `Annotated`?**
Porque desacoplas la definici√≥n de la validaci√≥n (FastAPI) de la sintaxis de argumentos de la funci√≥n (Python). Es m√°s limpio y te evita el error del Concepto C.

üî¥ **Fundamental**: A partir de FastAPI 0.95+, esta es la forma correcta de escribir tu c√≥digo.

---

## E - El Truco del Asterisco `*` (Kwargs) [üîµ]

#### 1. **Introducci√≥n:**

Un truco de Python para forzar que los argumentos se pasen por nombre, permiti√©ndote ordenar el c√≥digo como quieras sin usar `Annotated`.

#### 2. **Ejemplo:**

```python
# El asterisco (*) le dice a Python:
# "A partir de aqu√≠, todo se debe llamar por nombre (keyword arguments)".
async def read_items(
    *,
    item_id: int = Path(title="ID"),
    q: str
):
    pass
```

#### 3. **Desarrollo:**

Si por alguna raz√≥n **no** quieres usar `Annotated` y **tampoco** quieres reordenar tus par√°metros (quiz√°s por legibilidad), puedes poner un `*` como primer par√°metro de la funci√≥n.

Esto le dice a Python: "Ignora el orden posicional, todo lo que sigue son argumentos de palabra clave". As√≠, Python deja de quejarse sobre qu√© va primero o despu√©s.

üîµ **Espec√≠fico**: Es bueno saber que existe ("nice to have"), pero si usas `Annotated` (Concepto D), raramente necesitar√°s este truco.

---

## F - Validaciones Num√©ricas: `ge`, `le`, `gt`, `lt` [üü°]

#### 1. **Introducci√≥n:**

Palabras clave m√°gicas dentro de `Path` (y `Query`) para restringir rangos num√©ricos: mayor, menor o igual.

#### 2. **Ejemplo:**

```python
@app.get("/items/{item_id}")
async def read_items(
    item_id: Annotated[int, Path(title="ID", ge=1, le=1000)],
    q: str,
    size: Annotated[float, Query(gt=0, lt=10.5)]
):
    return {"item_id": item_id}
```

#### 3. **Desarrollo:**

Aqu√≠ es donde validamos la l√≥gica de negocio directamente en la entrada. Memoriza estas siglas, vienen de las matem√°ticas en ingl√©s:

- **`ge`** (Greater than or Equal): **Mayor o igual que** ($\ge$). Ej: `ge=1` (1 es v√°lido).
- **`le`** (Less than or Equal): **Menor o igual que** ($\le$). Ej: `le=1000` (1000 es v√°lido).
- **`gt`** (Greater Than): **Mayor que** ($>$). Ej: `gt=0` (0 NO es v√°lido, 0.1 s√≠).
- **`lt`** (Less Than): **Menor que** ($<$). Ej: `lt=10.5` (10.5 NO es v√°lido).

**Ojo con los Flotantes (`float`):**
El ejemplo incluye `size: float`. Las validaciones `gt` y `lt` son vitales aqu√≠. Si usas `ge=0` en un float, `0.0` es v√°lido. Si necesitas que sea estrictamente positivo, usa `gt=0`.

üü° **Importante**: Usar esto evita que tengas que escribir `if item_id < 1: raise Error` dentro de tu funci√≥n. FastAPI lo hace por ti y devuelve un error claro al cliente.
