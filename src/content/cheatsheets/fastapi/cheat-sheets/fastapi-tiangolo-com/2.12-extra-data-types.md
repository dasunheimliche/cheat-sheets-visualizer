---
title: "2.12 - Tipos de Datos Extra en FastAPI"
description: "Gu칤a sobre tipos de datos complejos (UUID, Fechas, Bytes) y c칩mo FastAPI los maneja autom치ticamente."
tags: ["fastapi", "python", "types", "validation"]
prompt-version: cheat-sheet-generator-1.1
---

## A - Tipos de Datos Complejos (Visi칩n General) [游댮]

#### 1. **Introducci칩n:**

Hasta ahora usaste tipos b치sicos (`int`, `str`), pero FastAPI puede manejar estructuras mucho m치s complejas autom치ticamente, conservando todas las ventajas de validaci칩n y documentaci칩n.

#### 2. **Ejemplo:**

Imagina que env칤as una fecha en texto (`"2023-01-01"`).

- **Sin FastAPI:** Recibes un `str`, tienes que ver si el formato es correcto y convertirlo manualmente a un objeto fecha para hacer c치lculos.
- **Con FastAPI:** Declaras el tipo `datetime`, y el sistema valida el formato y te entrega el objeto listo para usar.

#### 3. **Desarrollo:**

No te limites a `int` o `bool`. Puedes usar tipos que representan fechas, identificadores 칰nicos o estructuras de datos espec칤ficas.
Lo genial es que obtienes las mismas caracter칤sticas que ya conoces:

- **Soporte del editor:** Autocompletado inteligente.
- **Conversi칩n autom치tica:** De la petici칩n (request) a Python y de Python a la respuesta (response).
- **Validaci칩n:** Si el dato no cumple el formato complejo, FastAPI lanza el error.
- **Documentaci칩n:** Aparece correctamente tipado en el Swagger UI.

游댮 **Fundamental:** Entender esto es clave porque te ahorra escribir cientos de l칤neas de c칩digo para "parsear" (convertir) strings a objetos 칰tiles.

---

## B - UUID (Universally Unique Identifier) [游댮]

#### 1. **Introducci칩n:**

Es un est치ndar para crear IDs que son 칰nicos en todo el mundo (muy com칰n en bases de datos), evitando colisiones de IDs num칠ricos simples (1, 2, 3...).

#### 2. **Ejemplo:**

```python
from uuid import UUID
from fastapi import FastAPI

app = FastAPI()

# En la URL env칤as: /items/123e4567-e89b-12d3-a456-426614174000
@app.get("/items/{item_id}")
async def read_item(item_id: UUID):
    # item_id aqu칤 ya es un objeto UUID real de Python, no un string.
    return {"item_id": item_id}
```

#### 3. **Desarrollo:**

- **En la petici칩n (Request):** El cliente env칤a un `str` (cadena de texto). FastAPI verifica que tenga formato de UUID v치lido.
- **En Python:** T칰 recibes un objeto `UUID`.
- **En la respuesta (Response):** FastAPI lo convierte de nuevo a `str` para enviarlo en el JSON.

游댮 **Fundamental:** Es el est치ndar de facto para IDs en sistemas modernos distribuidos.

---

## C - datetime.datetime [游댮]

#### 1. **Introducci칩n:**

Representa un momento exacto en la historia: incluye tanto la **fecha** como la **hora**.

#### 2. **Ejemplo:**

```python
from datetime import datetime
# FastAPI espera un string ISO 8601
# Input JSON: "2008-09-15T15:53:00+05:00"
async def crear_evento(inicio: datetime):
    return {"inicio": inicio}
```

#### 3. **Desarrollo:**

Es el tipo de dato `datetime.datetime` nativo de Python.

- **Formato esperado:** ISO 8601 (ej: `AAAA-MM-DDTHH:MM:SS`).
- **Conversi칩n:** Se recibe y se env칤a como `str` en el JSON, pero dentro de tu funci칩n es un objeto con el que puedes operar.

游댮 **Fundamental:** Casi cualquier aplicaci칩n necesita registrar "cu치ndo" ocurri칩 algo con precisi칩n.

---

## D - datetime.date [游리]

#### 1. **Introducci칩n:**

Representa solo una fecha del calendario, sin importar la hora del reloj.

#### 2. **Ejemplo:**

```python
from datetime import date
# Input JSON: "2008-09-15"
async def registrar_nacimiento(cumpleanos: date):
    pass
```

#### 3. **Desarrollo:**

Es el tipo `datetime.date` de Python.

- **Formato:** ISO 8601 simple (`AAAA-MM-DD`).
- **Uso:** Ideal para cumplea침os, fechas de vencimiento o d칤as festivos donde la hora exacta no importa.

游리 **Importante:** 칔salo para ser sem치nticamente correcto. Si no necesitas la hora, no uses `datetime`.

---

## E - datetime.time [游댯]

#### 1. **Introducci칩n:**

Representa solo la hora del reloj, sin estar atada a una fecha espec칤fica.

#### 2. **Ejemplo:**

```python
from datetime import time
# Input JSON: "14:23:55.003"
async def configurar_alarma(hora: time):
    pass
```

#### 3. **Desarrollo:**

Es el tipo `datetime.time` de Python.

- **Formato:** ISO 8601 de tiempo (`HH:MM:SS.ms`).
- **Uso:** Horarios de apertura de tiendas, alarmas, turnos rotativos.

游댯 **Espec칤fico:** Menos com칰n que `datetime`, pero vital para sistemas de horarios.

---

## F - datetime.timedelta [游댯]

#### 1. **Introducci칩n:**

Representa una **duraci칩n** o diferencia de tiempo, no un momento en el calendario.

#### 2. **Ejemplo:**

```python
from datetime import timedelta
# Input JSON: 3600.5 (Total de segundos)
async def tiempo_de_proceso(duracion: timedelta):
    # duracion es un objeto timedelta, no un float
    pass
```

#### 3. **Desarrollo:**

Es el tipo `datetime.timedelta` de Python.

- **En la petici칩n/respuesta:** Se representa generalmente como un `float` que indica el **total de segundos**.
- **Nota:** Pydantic (la librer칤a que usa FastAPI) tambi칠n permite formatos de "codificaci칩n de diferencia de tiempo ISO 8601", pero lo m치s seguro y com칰n es pensar en segundos (float).

游댯 **Espec칤fico:** 칔til para cron칩metros, tiempos de espera o c치lculos de vencimiento (ej: "v치lido por 2 horas").

---

## G - frozenset [游댯]

#### 1. **Introducci칩n:**

Es como una lista, pero con dos reglas de oro: no puede tener elementos repetidos y no se puede modificar una vez creada.

#### 2. **Ejemplo:**

```python
# Input JSON: ["manzana", "pera", "manzana", "uva"]
async def lista_compras(items: frozenset[str]):
    # items ser치: {"manzana", "pera", "uva"} (sin duplicados)
    return items
# Output JSON: ["manzana", "pera", "uva"]
```

#### 3. **Desarrollo:**

- **En la petici칩n:** Se lee una lista (`[]`), se eliminan duplicados y se convierte a `set`.
- **En la respuesta:** El `set` se convierte de nuevo a lista (`[]`) porque JSON no tiene tipo "set".
- **Documentaci칩n:** El esquema generado avisar치 que los valores son 칰nicos (`uniqueItems`).

游댯 **Espec칤fico:** Perfecto para listas de etiquetas (tags), categor칤as o IDs donde la duplicaci칩n es un error.

---

## H - bytes [游댯]

#### 1. **Introducci칩n:**

Representa datos binarios crudos.

#### 2. **Ejemplo:**

```python
# Input/Output se trata como string
async def recibir_archivo(data: bytes):
    pass
```

#### 3. **Desarrollo:**

Es el tipo `bytes` est치ndar de Python.

- **Tratamiento:** En las peticiones y respuestas JSON, se maneja como un `str`.
- **Esquema:** Se documenta como un string con formato `binary`.

游댯 **Espec칤fico:** Se usa para manejo de archivos peque침os en base64 o streams de datos espec칤ficos, aunque para subida de archivos grandes FastAPI tiene herramientas dedicadas (`UploadFile`).

---

## I - Decimal [游댯]

#### 1. **Introducci칩n:**

N칰meros con decimales donde la precisi칩n es cr칤tica (como dinero), evitando los errores de redondeo de los `float`.

#### 2. **Ejemplo:**

```python
from decimal import Decimal
# Input JSON: 10.50
async def calcular_precio(precio: Decimal):
    pass
```

#### 3. **Desarrollo:**

Es el tipo `Decimal` est치ndar de Python.

- **Manejo:** En peticiones y respuestas se maneja igual que un `float`.

游댯 **Espec칤fico:** 칔salo siempre que trabajes con dinero o c치lculos cient칤ficos precisos.

---

## J - Manipulaci칩n de Datos (El "Poder" de la Conversi칩n) [游댮]

#### 1. **Introducci칩n:**

La gran ventaja de usar estos tipos es que dentro de tu funci칩n puedes hacer operaciones matem치ticas directas con ellos, sin conversiones manuales.

#### 2. **Ejemplo:**

```python
from datetime import datetime, timedelta
from fastapi import Body, FastAPI

app = FastAPI()

@app.put("/items/{item_id}")
async def read_items(
    start_datetime: datetime = Body(), # FastAPI convierte el string a objeto
    process_after: timedelta = Body(), # FastAPI convierte el float a objeto
):
    # 춰MAGIA! Puedes sumar fechas y duraciones directamente
    start_process = start_datetime + process_after

    return {
        "start_process": start_process # FastAPI lo vuelve a convertir a string ISO
    }
```

#### 3. **Desarrollo:**

Observa el ejemplo anterior.

1.  Recibes `start_datetime` (fecha) y `process_after` (duraci칩n).
2.  Como FastAPI ya los convirti칩 a objetos de Python, puedes usar el operador `+` para sumar tiempo.
3.  Calculas `start_process` matem치ticamente.
4.  Al retornar, FastAPI toma ese nuevo objeto calculado y lo serializa (convierte a texto) autom치ticamente para el JSON de respuesta.

**Nota sobre `Annotated`:** El texto original muestra ejemplos usando `Annotated` (recomendado en versiones modernas) y versiones sin 칠l. La funcionalidad es id칠ntica, `Annotated` es solo una forma m치s moderna y limpia de escribirlo.

游댮 **Fundamental:** Aqu칤 es donde FastAPI brilla. Te permite escribir l칩gica de negocio limpia ("sumar fecha A + tiempo B") en lugar de l칩gica de fontaner칤a ("convertir string A a fecha, convertir float B a tiempo, sumar, convertir resultado a string").
