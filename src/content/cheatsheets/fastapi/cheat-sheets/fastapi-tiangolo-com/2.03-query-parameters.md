---
title: "1.2 - Query Parameters en FastAPI"
description: "Gu칤a definitiva para entender y manejar par치metros de consulta en URLs con FastAPI"
tags: ["fastapi", "python", "web", "query-params"]
---

## A - Definici칩n y Detecci칩n Autom치tica [游댮]

#### 1. **Introducci칩n:**

Los **Query Parameters** son todos aquellos par치metros que declaras en tu funci칩n pero que **NO** est치n escritos en la ruta (el path) de tu decorador `@app.get`.

#### 2. **Ejemplo:**

```python
from fastapi import FastAPI
app = FastAPI()

# La ruta NO tiene variables como {skip} o {limit}
@app.get("/items/")
async def read_item(skip: int = 0, limit: int = 10):
    # Como 'skip' y 'limit' no est치n en "/items/", FastAPI asume que son Query Params
    return {"skip": skip, "limit": limit}
```

#### 3. **Desarrollo:**

FastAPI es muy listo. Cuando ve que pides un dato en la funci칩n (ej: `skip`), mira la URL (`/items/`). Si `skip` no est치 en la URL, autom치ticamente decide: "Ah, esto debe ser un Query Parameter". No tienes que configurar nada extra.

游댮 **Fundamental**: Es la forma b치sica en que pasamos filtros, configuraciones o datos extra que no son identificadores 칰nicos de un recurso.

---

## B - Anatom칤a en la URL [游댮]

#### 1. **Introducci칩n:**

Son los pares clave-valor que van al final de la URL, empezando despu칠s de un signo de interrogaci칩n `?` y separados por `&`.

#### 2. **Ejemplo:**

Si tu funci칩n espera `skip` y `limit`, la URL se ve as칤:

`http://127.0.0.1:8000/items/?skip=0&limit=10`

**Explicaci칩n del ejemplo:**

- `?`: Indica "aqu칤 empiezan los query params".
- `skip=0`: Primer par치metro.
- `&`: Indica "y aqu칤 viene otro par치metro".
- `limit=10`: Segundo par치metro.

#### 3. **Desarrollo:**

Aunque en la URL todo es texto (strings), estos valores corresponden a las variables que definiste en tu funci칩n de Python.

游댮 **Fundamental**: Entender esta estructura es vital para saber c칩mo llamar a tu API desde un navegador o cliente HTTP.

---

## C - Conversi칩n y Validaci칩n de Tipos [游댮]

#### 1. **Introducci칩n:**

FastAPI convierte autom치ticamente el texto de la URL al tipo de dato que definiste en Python (como `int`), y si no coincide, da error.

#### 2. **Ejemplo:**

```python
# Definimos 'skip' y 'limit' como enteros (int)
async def read_item(skip: int = 0, limit: int = 10):
    return "Todo correcto"
```

Si llamas a: `.../items/?skip=hola`
FastAPI responder치 con un error porque "hola" no es un n칰mero.

#### 3. **Desarrollo:**

Esto te ahorra tener que escribir c칩digo para transformar "10" (texto) a `10` (n칰mero) manualmente. Adem치s, obtienes validaci칩n de datos y documentaci칩n autom치tica gratis.

游댮 **Fundamental**: Es una de las caracter칤sticas estrella de FastAPI; garantiza que tu c칩digo reciba datos limpios y del tipo correcto.

---

## D - Valores por Defecto (Defaults) [游리]

#### 1. **Introducci칩n:**

Puedes asignar un valor inicial a tus par치metros para que, si el usuario no los env칤a en la URL, tu funci칩n use ese valor predefinido.

#### 2. **Ejemplo:**

```python
# skip ser치 0 si no se env칤a nada
# limit ser치 10 si no se env칤a nada
async def read_item(skip: int = 0, limit: int = 10):
    return fake_items_db[skip : skip + limit]
```

- URL: `/items/` -> Usa `skip=0`, `limit=10`.
- URL: `/items/?skip=20` -> Usa `skip=20`, `limit=10` (mantiene el default del que falta).

#### 3. **Desarrollo:**

Esto hace que los par치metros sean **no obligatorios**. El usuario puede elegir enviarlos o confiar en tu configuraci칩n est치ndar.

游리 **Importante**: Muy 칰til para paginaci칩n o configuraciones est치ndar donde no quieres obligar al usuario a escribir todo siempre.

---

## E - Par치metros Opcionales (El truco del `None`) [游리]

#### 1. **Introducci칩n:**

Si quieres un par치metro que sea verdaderamente opcional (que pueda "no existir" o ser nulo), declaras su valor por defecto como `None`.

#### 2. **Ejemplo:**

```python
from typing import Union # Para Python 3.10+ puedes usar solo |

# q es opcional. Por defecto es None.
async def read_item(item_id: str, q: Union[str, None] = None):
    if q:
        return {"item_id": item_id, "q": q}
    return {"item_id": item_id}
```

#### 3. **Desarrollo:**

Al usar `= None`, le dices a FastAPI dos cosas:

1.  El par치metro no es obligatorio.
2.  Si no lo env칤an, la variable `q` valdr치 `None` (칰til para l칩gica `if q:`).

游리 **Importante**: Es la forma est치ndar de manejar filtros de b칰squeda opcionales.

---

## F - Conversi칩n Inteligente de Booleanos [游댯]

#### 1. **Introducci칩n:**

Para par치metros de tipo `bool` (verdadero/falso), FastAPI es extremadamente flexible y entiende muchas variaciones de "s칤" y "no" en la URL.

#### 2. **Ejemplo:**

```python
async def read_item(short: bool = False):
    if short:
        return "Descripci칩n corta"
    return "Descripci칩n larga..."
```

Todas estas URLs har치n que `short` sea `True`:

- `?short=1`
- `?short=True`
- `?short=true`
- `?short=on`
- `?short=yes`

#### 3. **Desarrollo:**

Cualquier otra cosa se interpretar치 como `False` (o dar치 error si no es un valor booleano v치lido). No tienes que programar un "parser" para saber si el usuario escribi칩 "yes" o "True".

游댯 **Espec칤fico**: Una "magia" muy conveniente de FastAPI para flags o interruptores.

---

## G - Mezcla de Path y Query Parameters [游리]

#### 1. **Introducci칩n:**

Puedes usar Path Parameters (en la ruta) y Query Parameters (fuera de la ruta) en la misma funci칩n; FastAPI sabr치 cu치l es cu치l por sus nombres.

#### 2. **Ejemplo:**

```python
# {user_id} e {item_id} est치n en la ruta -> Son PATH params
# q y short NO est치n en la ruta -> Son QUERY params
@app.get("/users/{user_id}/items/{item_id}")
async def read_user_item(
    user_id: int,
    item_id: str,
    q: Union[str, None] = None,
    short: bool = False
):
    return {"user": user_id, "item": item_id, "query": q}
```

#### 3. **Desarrollo:**

**춰Ojo aqu칤!** No importa el orden en que los escribas en los argumentos de la funci칩n (`def`). FastAPI escanea la cadena de la ruta (`/users/{user_id}...`), detecta qu칠 variables est치n ah칤, y asume que **todo lo dem치s** son Query Parameters.

游리 **Importante**: Permite crear APIs complejas y flexibles sin confundir al sistema.

---

## H - Par치metros Obligatorios (Required) [游리]

#### 1. **Introducci칩n:**

Si quieres que un Query Parameter sea **obligatorio**, simplemente define el tipo pero **NO le des un valor por defecto**.

#### 2. **Ejemplo:**

```python
# 'needy' es obligatorio (no tiene = algo)
# 'skip' tiene default, as칤 que no es obligatorio
async def read_user_item(item_id: str, needy: str, skip: int = 0):
    return {"needy": needy}
```

Si vas a `/items/foo-item` sin enviar `needy`, recibir치s un error JSON indicando `Field required`.
Debes ir a: `/items/foo-item?needy=valor`

#### 3. **Desarrollo:**

A diferencia de los par치metros opcionales (`= None`) o con defaults (`= 0`), aqu칤 obligas al cliente a enviar el dato. Si falta, la petici칩n falla antes de ejecutar tu c칩digo.

游리 **Importante**: 칔salo para datos cr칤ticos sin los cuales tu funci칩n no puede trabajar (ej: un token espec칤fico, un ID de referencia externo).
