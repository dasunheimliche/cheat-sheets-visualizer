---
title: "2.19 - Response Status Code en FastAPI"
description: "C√≥mo controlar y documentar los c√≥digos de estado HTTP en tus respuestas"
tags: ["fastapi", "http", "status-code", "best-practices"]
prompt-version: cheat-sheet-generator-1.1
---

## A - El par√°metro `status_code`: Definiendo el "Qu√© pas√≥" [üî¥]

#### 1. **Introducci√≥n:**

Es un par√°metro que le dice a FastAPI qu√© n√∫mero (c√≥digo HTTP) debe enviar al navegador para indicar si la operaci√≥n sali√≥ bien, si se cre√≥ algo, o si hubo un error.

#### 2. **Ejemplo:**

```python
from fastapi import FastAPI

app = FastAPI()

# Aqu√≠ definimos que si todo sale bien, el c√≥digo ser√° 201 (Created)
@app.post("/items/", status_code=201)
async def create_item(name: str):
    return {"name": name}
```

#### 3. **Desarrollo:**

En HTTP, no basta con enviar datos (el JSON); tambi√©n env√≠as un n√∫mero de 3 d√≠gitos que resume el resultado. Por defecto, FastAPI suele enviar `200` (OK), pero a veces necesitas ser m√°s espec√≠fico. Este par√°metro acepta un n√∫mero entero (`int`) o un `IntEnum`.

üî¥ **Fundamental**: Sin esto, tu API siempre dir√≠a "200 OK" incluso cuando creas recursos nuevos, lo cual no es una buena pr√°ctica REST.

---

## B - Ubicaci√≥n del `status_code`: ¬°La Trampa del Decorador! [üî¥]

#### 1. **Introducci√≥n:**

El `status_code` **SIEMPRE** va dentro del par√©ntesis del decorador (`@app.get(...)`), **NUNCA** en los argumentos de tu funci√≥n.

#### 2. **Ejemplo:**

```python
# ‚úÖ CORRECTO: Est√° en el decorador
@app.post("/items/", status_code=201)
async def create_item(name: str):
    return {"name": name}

# ‚ùå INCORRECTO: No lo pongas aqu√≠ abajo
# async def create_item(name: str, status_code=201): ...
```

#### 3. **Desarrollo:**

Esta es la confusi√≥n n√∫mero uno de los principiantes. Tu funci√≥n (`create_item`) se encarga de la _l√≥gica_ y el _cuerpo_ de la respuesta. El decorador (`@app.post`) se encarga de la _configuraci√≥n_ de la ruta y los metadatos HTTP. Si pones `status_code` en la funci√≥n, FastAPI pensar√° que es un par√°metro de consulta (query param) o del cuerpo, y no cambiar√° el c√≥digo HTTP.

üî¥ **Fundamental**: Si te equivocas aqu√≠, tu API no funcionar√° como esperas y te costar√° encontrar el error.

---

## C - Efectos Visibles: Respuesta y Documentaci√≥n [üü°]

#### 1. **Introducci√≥n:**

Usar `status_code` hace dos cosas: cambia el encabezado HTTP real que recibe el cliente y actualiza autom√°ticamente la documentaci√≥n interactiva.

#### 2. **Ejemplo:**

_(Ver imagen abajo para el efecto en la documentaci√≥n)_

**Explicaci√≥n del ejemplo:**
Al definir `status_code=201`, FastAPI modifica el esquema OpenAPI.

#### 3. **Desarrollo:**

1.  **En la respuesta:** El cliente recibe el c√≥digo num√©rico (ej. 201).
2.  **En la documentaci√≥n:** La interfaz (Swagger UI) mostrar√° expl√≠citamente que esa ruta devuelve ese c√≥digo espec√≠fico.

![Documentaci√≥n mostrando c√≥digo 201](https://fastapi.tiangolo.com/img/tutorial/response-status-code/image01.png)

üü° **Importante**: Mantiene tu documentaci√≥n sincronizada con la realidad de tu c√≥digo sin esfuerzo extra.

---

## D - Resumen de C√≥digos HTTP (100-599) [üü°]

#### 1. **Introducci√≥n:**

Los c√≥digos HTTP son universales y se agrupan por centenas seg√∫n su significado general.

#### 2. **Ejemplo:**

- **2xx**: ¬°Todo bien!
- **4xx**: ¬°T√∫ (cliente) te equivocaste!
- **5xx**: ¬°Yo (servidor) me equivoqu√©!

#### 3. **Desarrollo:**

No necesitas memorizarlos todos, pero s√≠ los rangos:

- **100-199 (Informaci√≥n):** Raramente los usas directamente. No tienen cuerpo.
- **200-299 (√âxito):** Los m√°s usados. Todo sali√≥ bien.
- **300-399 (Redirecci√≥n):** "Vete a buscar esto a otro lado".
- **400-499 (Error del Cliente):** Faltan datos, no existe la p√°gina, no tienes permiso.
- **500-599 (Error del Servidor):** Tu c√≥digo fall√≥, base de datos ca√≠da, etc.

üü° **Importante**: Conocer los rangos te ayuda a depurar r√°pidamente (¬øes culpa m√≠a o del usuario?).

---

## E - C√≥digos de √âxito: 200 vs 201 [üü°]

#### 1. **Introducci√≥n:**

Diferencia clave: `200` es un "OK" gen√©rico, mientras que `201` significa espec√≠ficamente "Creado".

#### 2. **Ejemplo:**

```python
# Caso A: Leer datos (GET) -> Usamos 200 (por defecto)
@app.get("/items/")
def read_items(): ...

# Caso B: Crear datos (POST) -> Usamos 201
@app.post("/items/", status_code=201)
def create_item(): ...
```

#### 3. **Desarrollo:**

- **200 OK:** Es el c√≥digo por defecto en FastAPI. √ösalo para consultas, actualizaciones o borrados que devuelven datos.
- **201 Created:** √ösalo t√≠picamente en m√©todos `POST` cuando se inserta un nuevo registro en la base de datos.

üü° **Importante**: Usar `201` ayuda a los clientes de tu API a saber que la operaci√≥n de escritura fue exitosa y gener√≥ algo nuevo.

---

## F - C√≥digos sin Cuerpo: 204 y 304 [üîµ]

#### 1. **Introducci√≥n:**

Hay c√≥digos que indican √©xito o estado, pero que por definici√≥n **no deben llevar contenido (body)** en la respuesta.

#### 2. **Ejemplo:**

- **204 (No Content):** "Lo hice, pero no tengo nada que mostrarte". Com√∫n al borrar (DELETE) algo.
- **304 (Not Modified):** "Esto no ha cambiado desde la √∫ltima vez que lo viste".

#### 3. **Desarrollo:**

FastAPI es inteligente. Si configuras un `status_code=204`, √©l sabe que no debe esperar ni documentar un cuerpo de respuesta.

- **¬°Cuidado!**: Si intentas devolver un JSON con un 204, el navegador podr√≠a ignorarlo o confundirse, ya que el protocolo dice "sin contenido".

üîµ **Espec√≠fico**: Se usa en casos puntuales de optimizaci√≥n (cach√©) o limpieza (borrado).

---

## G - C√≥digos de Error: 4xx vs 5xx [üü°]

#### 1. **Introducci√≥n:**

Distinci√≥n vital para saber a qui√©n culpar cuando algo falla.

#### 2. **Ejemplo:**

- **404 (Not Found):** El cliente pidi√≥ el ID 99 y no existe. (Culpa del cliente).
- **400 (Bad Request):** Error gen√©rico del cliente (envi√≥ mal los datos).
- **500 (Internal Server Error):** Tu c√≥digo Python tuvo una excepci√≥n no controlada. (Culpa tuya).

#### 3. **Desarrollo:**

- **4xx**: T√∫ controlas estos errores y se los lanzas al usuario para decirle qu√© hizo mal.
- **5xx**: Generalmente no los lanzas t√∫ manualmente; ocurren cuando tu servidor explota. FastAPI maneja los 500 autom√°ticamente para que el servidor no se caiga por completo.

üü° **Importante**: Nunca devuelvas un 500 si el usuario envi√≥ mal un dato; usa un 400.

---

## H - Atajo `fastapi.status`: Adi√≥s a los N√∫meros M√°gicos [üü°]

#### 1. **Introducci√≥n:**

En lugar de escribir n√∫meros (`201`, `404`) que puedes olvidar o escribir mal, usa las constantes con nombre que provee FastAPI.

#### 2. **Ejemplo:**

```python
from fastapi import FastAPI, status  # <--- Importamos status

app = FastAPI()

# Usamos el autocompletado del editor
@app.post("/items/", status_code=status.HTTP_201_CREATED)
async def create_item(name: str):
    return {"name": name}
```

#### 3. **Desarrollo:**

`status.HTTP_201_CREATED` es simplemente una variable que vale `201`.
¬øPor qu√© usarlo?

1.  **Autocompletado:** Tu editor te sugerir√° los c√≥digos.
2.  **Legibilidad:** Es m√°s f√°cil entender `HTTP_204_NO_CONTENT` que recordar qu√© significaba el n√∫mero 204.

![Autocompletado de status](https://fastapi.tiangolo.com/img/tutorial/response-status-code/image02.png)

üü° **Importante**: Es una "buena pr√°ctica" de programaci√≥n para evitar errores humanos (typos).

---

## I - `fastapi.status` vs `starlette.status` [üîµ]

#### 1. **Introducci√≥n:**

FastAPI te da acceso a `status` directamente, pero internamente vienen de Starlette (la librer√≠a base).

#### 2. **Ejemplo:**

```python
from fastapi import status
# Es exactamente igual a:
from starlette import status
```

#### 3. **Desarrollo:**

FastAPI incluye `starlette.status` dentro de `fastapi.status` solo por **conveniencia**, para que no tengas que importar cosas de dos librer√≠as diferentes. Como desarrollador de FastAPI, usa siempre `from fastapi import status` para mantener tu c√≥digo limpio y consistente.

üîµ **Espec√≠fico**: Solo necesitas saber esto para entender que no hay magia, es una re-exportaci√≥n.
