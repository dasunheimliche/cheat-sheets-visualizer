---
title: "2.09 - Body Fields en FastAPI"
description: "Uso de Field para validar atributos dentro de modelos Pydantic"
tags: ["fastapi", "pydantic", "field", "validation"]
prompt-version: cheat-sheet-generator-1.1
---

## A - Importaci√≥n de `Field`: ¬°Cuidado con el Origen! [üî¥]

#### 1. **Introducci√≥n:**

Para usar `Field`, primero debes importarlo. **Ojo aqu√≠:** a diferencia de `Query`, `Path` o `Body` que vienen de `fastapi`, `Field` debe importarse directamente desde la librer√≠a `pydantic`.

#### 2. **Ejemplo:**

```python
# ‚ùå INCORRECTO (Error com√∫n de principiante)
from fastapi import Body, FastAPI, Field  # Field NO vive aqu√≠

# ‚úÖ CORRECTO
from fastapi import Body, FastAPI
from pydantic import BaseModel, Field # <--- Field vive en Pydantic
```

#### 3. **Desarrollo:**

[üî¥] **Fundamental**: Esta es la "trampa" n√∫mero uno. FastAPI utiliza Pydantic para todo lo que tiene que ver con modelos de datos.

- **`Query`, `Path`, `Body`**: Son herramientas de **FastAPI** para leer la petici√≥n HTTP (URL, par√°metros).
- **`Field`**: Es una herramienta de **Pydantic** para definir la estructura interna de los datos (clases).

Si intentas importar `Field` desde `fastapi`, tu c√≥digo fallar√°. Recuerda: **Si est√° DENTRO de una `class` (modelo), generalmente necesitas herramientas de `pydantic`**.

---

## B - Declaraci√≥n de Atributos y Validaciones [üî¥]

#### 1. **Introducci√≥n:**

`Field` funciona igual que `Query` o `Path`, pero se usa **dentro** de las clases (modelos Pydantic) para a√±adir validaciones (como longitud m√°xima o valores num√©ricos) y metadatos a cada atributo.

#### 2. **Ejemplo:**

```python
from typing import Annotated
from fastapi import Body, FastAPI
from pydantic import BaseModel, Field

app = FastAPI()

# Definimos nuestro modelo de datos
class Item(BaseModel):
    name: str
    # Usamos Field para validar la descripci√≥n
    description: str | None = Field(
        default=None,
        title="The description of the item",
        max_length=300
    )
    # Usamos Field para validar el precio (gt = greater than / mayor que)
    price: float = Field(gt=0, description="The price must be greater than zero")
    tax: float | None = None

@app.put("/items/{item_id}")
async def update_item(item_id: int, item: Annotated[Item, Body(embed=True)]):
    results = {"item_id": item_id, "item": item}
    return results
```

**Explicaci√≥n del ejemplo:**
En la clase `Item`:

- `description`: Puede ser `str` o `None`. Si se env√≠a, no puede tener m√°s de 300 caracteres (`max_length=300`).
- `price`: Debe ser un n√∫mero flotante y **obligatoriamente** mayor que 0 (`gt=0`). Tambi√©n a√±adimos una descripci√≥n para la documentaci√≥n.
- Nota c√≥mo `Field` se asigna directamente al atributo de la clase, igual que har√≠as con un valor por defecto.

#### 3. **Desarrollo:**

[üî¥] **Fundamental**: Sin `Field`, solo podr√≠as definir el _tipo_ de dato (ej: `int`, `str`). Con `Field`, defines las _reglas_ del dato.
Los par√°metros que acepta `Field` son los mismos que ya conoces de `Query`, `Path` y `Body`. Esto incluye validaciones num√©ricas (`gt`, `lt`), de longitud (`min_length`, `max_length`) y metadatos (`title`, `description`).

---

## C - Comparaci√≥n: `Field` vs. `Query`/`Path`/`Body` [üü°]

#### 1. **Introducci√≥n:**

Aunque se usan en lugares diferentes, `Field` funciona conceptualmente igual que sus "hermanos" de FastAPI. La diferencia es el **contexto** donde se aplican.

#### 2. **Ejemplo:**

- **En una Funci√≥n (Path Operation):**

  ```python
  # Usas Path/Query para validar par√°metros de la URL
  def ruta(q: str = Query(max_length=50)): ...
  ```

- **En una Clase (Modelo Pydantic):**
  ```python
  # Usas Field para validar atributos del JSON
  class Modelo(BaseModel):
      q: str = Field(max_length=50)
  ```

#### 3. **Desarrollo:**

[üü°] **Importante**:

- Usa **`Query` / `Path`** cuando necesites validar variables que viajan en la **URL**.
- Usa **`Field`** cuando necesites validar variables que viajan dentro del **Cuerpo (Body) JSON** y son parte de un modelo (clase).

**Nota Pedag√≥gica:** Observa que la estructura es id√©ntica: `variable: tipo = Herramienta(validaciones)`. FastAPI est√° dise√±ado para que si aprendes a usar uno, sepas usarlos todos.

---

## D - Detalles T√©cnicos: La Familia `FieldInfo` [üîµ]

#### 1. **Introducci√≥n:**

T√©cnicamente, `Query`, `Path` y `Body` son funciones que crean objetos que son "hijos" o subclases de la misma l√≥gica que usa `Field`.

#### 2. **Ejemplo:**

_(No hay c√≥digo para ejecutar aqu√≠, es un concepto de arquitectura)_
Imagina un √°rbol geneal√≥gico:

- Abuelo: `FieldInfo` (Clase base de Pydantic)
- Padre: `Param` (Clase base de FastAPI)
- Hijos: `Query`, `Path`, `Body`

`Field` (de Pydantic) devuelve una instancia de `FieldInfo`.
`Query`, `Path`, etc. (de FastAPI) devuelven instancias de subclases de `FieldInfo`.

#### 3. **Desarrollo:**

[üîµ] **Espec√≠fico**: ¬øPor qu√© te cuento esto? Para que entiendas por qu√© comparten los mismos par√°metros (`gt`, `max_length`, etc.). No es magia ni coincidencia; **son la misma cosa bajo el cap√≥**. `Body` y sus variantes son esencialmente envoltorios especializados de `Field` adaptados para FastAPI.

---

## E - Informaci√≥n Extra y Advertencias OpenAPI [üü°]

#### 1. **Introducci√≥n:**

Puedes pasar argumentos extra a `Field` que no sean validaciones est√°ndar. Estos se incluir√°n en el esquema JSON final, pero debes tener cuidado con la compatibilidad.

#### 2. **Ejemplo:**

```python
# Pasando un argumento extra "extra_data"
price: float = Field(gt=0, extra_data="some info")
```

**Resultado en JSON Schema:**
El esquema generado incluir√° `"extra_data": "some info"`.

#### 3. **Desarrollo:**

[üü°] **Importante**:
Esto es √∫til para a√±adir metadatos personalizados a tu documentaci√≥n.
**¬°Advertencia Paranoica!**: Todo lo que pases a `Field` terminar√° en el esquema OpenAPI de tu API.

- Si usas herramientas externas para validar tu API (como **OpenAPI Validator**), estas podr√≠an fallar si encuentran claves "extra√±as" que no pertenecen a la especificaci√≥n oficial de OpenAPI.
- √ösalo con precauci√≥n si tu API debe cumplir est√°ndares estrictos o ser consumida por herramientas autom√°ticas r√≠gidas.
