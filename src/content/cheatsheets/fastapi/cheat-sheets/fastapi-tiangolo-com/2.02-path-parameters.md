---
title: "2.02 - Path Parameters en FastAPI"
description: "C√≥mo capturar, validar y tipar variables directamente desde la URL"
tags: ["fastapi", "python", "routing", "validation"]
---

## A - Declaraci√≥n B√°sica de Path Parameters [üî¥]

#### 1. **Introducci√≥n:**

Es la forma de decirle a FastAPI que una parte de la URL es una variable que quieres capturar para usarla en tu c√≥digo. Se usa la misma sintaxis que las "f-strings" de Python.

#### 2. **Ejemplo:**

```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/items/{item_id}") # {item_id} es la variable
async def read_item(item_id):
    # El valor de la URL se pasa a esta funci√≥n
    return {"item_id": item_id}
```

**Explicaci√≥n del ejemplo:**
Si un usuario visita `http://127.0.0.1:8000/items/foo`, FastAPI captura "foo", lo asigna al argumento `item_id` de la funci√≥n `read_item`, y la funci√≥n devuelve `{"item_id": "foo"}`.

#### 3. **Desarrollo:**

[üî¥] **Fundamental**: Sin esto, no podr√≠as crear APIs din√°micas (como obtener un usuario espec√≠fico o un producto por su ID). Es la base de la interacci√≥n REST.

---

## B - Tipado y Conversi√≥n Autom√°tica (Parsing) [üî¥]

#### 1. **Introducci√≥n:**

Puedes definir el tipo de dato que esperas (como `int`, `str`, `float`) usando las anotaciones de tipo est√°ndar de Python. FastAPI convertir√° autom√°ticamente lo que llegue en la URL a ese tipo.

#### 2. **Ejemplo:**

```python
@app.get("/items/{item_id}")
async def read_item(item_id: int): # Aqu√≠ definimos que DEBE ser un entero
    return {"item_id": item_id}
```

**Explicaci√≥n del ejemplo:**
Si visitas `http://127.0.0.1:8000/items/3`:

1. FastAPI lee el "3" de la URL (que originalmente es texto).
2. Ve que `item_id` debe ser `int`.
3. Convierte "3" a el n√∫mero `3`.
4. Tu funci√≥n recibe un n√∫mero real, no un texto.

#### 3. **Desarrollo:**

Esto te da soporte en tu editor de c√≥digo (autocompletado, detecci√≥n de errores) porque el editor ahora sabe que esa variable es un n√∫mero.

[üî¥] **Fundamental**: Ahorra tener que escribir c√≥digo manual para convertir `int("3")` dentro de tus funciones.

---

## C - Validaci√≥n de Datos (Data Validation) [üî¥]

#### 1. **Introducci√≥n:**

Si defines un tipo (ej. `int`) y el usuario env√≠a algo que no coincide (ej. "foo"), FastAPI detiene la ejecuci√≥n y devuelve un error HTTP claro y descriptivo autom√°ticamente.

#### 2. **Ejemplo:**

Si intentas acceder a `http://127.0.0.1:8000/items/foo` con el c√≥digo del concepto anterior (que espera un `int`), recibir√°s este JSON:

```json
{
  "detail": [
    {
      "type": "int_parsing",
      "loc": ["path", "item_id"],
      "msg": "Input should be a valid integer, unable to parse string as an integer",
      "input": "foo"
    }
  ]
}
```

#### 3. **Desarrollo:**

FastAPI te dice exactamente d√≥nde fall√≥ (`path` -> `item_id`) y por qu√©. Esto funciona igual para `float`, `bool` y otros tipos.

[üî¥] **Fundamental**: Garantiza que tu c√≥digo nunca se rompa por recibir datos basura. Si tu funci√≥n espera un n√∫mero, FastAPI asegura que reciba un n√∫mero o devuelva un error al cliente antes de ejecutar tu l√≥gica.

---

## D - Documentaci√≥n Autom√°tica (Swagger UI & ReDoc) [üü°]

#### 1. **Introducci√≥n:**

Gracias a que definiste los tipos en el paso anterior, FastAPI genera autom√°ticamente una p√°gina web interactiva para probar tu API.

#### 2. **Ejemplo:**

Al ir a `http://127.0.0.1:8000/docs`, ver√°s esto:

![](https://fastapi.tiangolo.com/img/tutorial/path-params/image01.png)

#### 3. **Desarrollo:**

Observa en la imagen que dice "integer". FastAPI ley√≥ tu c√≥digo y actualiz√≥ la documentaci√≥n.
Tambi√©n existe una versi√≥n alternativa en `/redoc`:

![](https://fastapi.tiangolo.com/img/tutorial/path-params/image02.png)

[üü°] **Importante**: Facilita enormemente el trabajo en equipo y las pruebas, ya que no tienes que escribir documentaci√≥n manual que se desactualiza. Todo se basa en el est√°ndar **OpenAPI**.

---

## E - Pydantic: El Motor Oculto [üîµ]

#### 1. **Introducci√≥n:**

Toda la validaci√≥n y conversi√≥n de datos que vimos arriba es realizada internamente por una librer√≠a llamada **Pydantic**.

#### 2. **Desarrollo:**

No necesitas hacer nada extra, pero es bueno saber que est√°s respaldado por esta herramienta. Puedes usar tipos complejos de Pydantic y FastAPI los entender√°.

[üîµ] **Espec√≠fico**: Es "cultura general" de FastAPI. Saberlo te da confianza en la robustez del sistema.

---

## F - El Orden de las Rutas (Order Matters) [üî¥]

#### 1. **Introducci√≥n:**

¬°Cuidado aqu√≠! Las rutas se eval√∫an en orden, de arriba hacia abajo. Si tienes una ruta fija (ej. `/users/me`) y una din√°mica (ej. `/users/{user_id}`), la fija debe ir **primero**.

#### 2. **Ejemplo del Error Com√∫n (La Trampa):**

```python
# ‚ùå MAL: FastAPI pensar√° que "me" es un user_id
@app.get("/users/{user_id}")
async def read_user(user_id: str):
    return {"user_id": user_id}

@app.get("/users/me")
async def read_user_me():
    return {"user_id": "the current user"}
```

**Correcci√≥n (Lo que debes hacer):**

```python
# ‚úÖ BIEN: Primero la ruta espec√≠fica, luego la general
@app.get("/users/me")
async def read_user_me():
    return {"user_id": "the current user"}

@app.get("/users/{user_id}")
async def read_user(user_id: str):
    return {"user_id": user_id}
```

#### 3. **Desarrollo:**

Si pones la din√°mica primero, al visitar `/users/me`, FastAPI coincidir√° con `/users/{user_id}` y asignar√° el valor "me" a la variable `user_id`, nunca llegando a ejecutar la funci√≥n espec√≠fica de `read_user_me`.

[üî¥] **Fundamental**: Es la fuente n√∫mero 1 de bugs para principiantes en routing. Recuerda: **Lo espec√≠fico antes que lo gen√©rico.**

---

## G - Valores Predefinidos: Creando Enums [üü°]

#### 1. **Introducci√≥n:**

Si quieres que tu par√°metro solo acepte un conjunto cerrado de valores (ej: solo "alexnet", "resnet" o "lenet"), usa un `Enum` de Python.

#### 2. **Ejemplo:**

```python
from enum import Enum
from fastapi import FastAPI

# Heredar de str y Enum permite que la doc sepa que son strings
class ModelName(str, Enum):
    alexnet = "alexnet"
    resnet = "resnet"
    lenet = "lenet"

app = FastAPI()
```

#### 3. **Desarrollo:**

Al heredar de `str`, ayudas a que la documentaci√≥n se renderice correctamente indicando que los valores son cadenas de texto.

[üü°] **Importante**: Ideal para opciones de configuraci√≥n, categor√≠as fijas o estados, evitando que el usuario env√≠e textos arbitrarios.

---

## H - Valores Predefinidos: Usando Enums [üü°]

#### 1. **Introducci√≥n:**

Usas la clase Enum creada como el "tipo" de tu par√°metro. Esto habilita un men√∫ desplegable en la documentaci√≥n y validaci√≥n estricta.

#### 2. **Ejemplo:**

```python
@app.get("/models/{model_name}")
async def get_model(model_name: ModelName): # Usamos la clase Enum aqu√≠

    # Comparaci√≥n directa con el miembro del Enum
    if model_name is ModelName.alexnet:
        return {"message": "Deep Learning FTW!"}

    # Acceso al valor real (string) usando .value
    if model_name.value == "lenet":
        return {"message": "LeCNN all the images"}

    return {"model_name": model_name}
```

#### 3. **Desarrollo:**

- **Documentaci√≥n**: Se ver√° as√≠, con un selector predefinido:
  ![](https://fastapi.tiangolo.com/img/tutorial/path-params/image03.png)
- **Retorno**: Si devuelves el miembro del Enum (ej. `return model_name`), FastAPI lo convertir√° autom√°ticamente a su valor string (`"alexnet"`) en el JSON de respuesta.

[üü°] **Importante**: Hace tu API mucho m√°s robusta y autodocumentada.

---

## I - Path Parameters que contienen rutas (Path Convertor) [üîµ]

#### 1. **Introducci√≥n:**

A veces necesitas enviar una ruta de archivo dentro de la URL, como `/files/home/johndoe/myfile.txt`. Por defecto, las barras `/` romper√≠an la URL. FastAPI permite "tragarse" el resto de la ruta usando `:path`.

#### 2. **Ejemplo:**

```python
# Nota el ":path" al final de la variable
@app.get("/files/{file_path:path}")
async def read_file(file_path: str):
    return {"file_path": file_path}
```

**Explicaci√≥n del ejemplo:**
Si llamas a `/files/home/johndoe/myfile.txt`:

- Sin `:path`: FastAPI buscar√≠a una ruta que no existe.
- Con `:path`: La variable `file_path` capturar√° `home/johndoe/myfile.txt` completo.

#### 3. **Desarrollo:**

Esto usa una herramienta interna de Starlette. Ten en cuenta que OpenAPI no soporta esto nativamente de forma perfecta, por lo que la documentaci√≥n autom√°tica funcionar√° pero no explicar√° expl√≠citamente que el par√°metro puede contener rutas.

[üîµ] **Espec√≠fico**: Solo √∫til si est√°s construyendo sistemas de archivos, proxies o manejando URLs como par√°metros.
