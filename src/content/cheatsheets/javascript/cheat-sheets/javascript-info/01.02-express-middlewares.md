---
title: "Express Middlewares"
description: "GuÃ­a completa sobre middlewares en Express.js"
order: 2
---

## A - Â¿QuÃ© es un Middleware? ğŸ”´

#### 1. **IntroducciÃ³n:**

Un middleware es una funciÃ³n que se interpone en el ciclo peticiÃ³n-respuesta de Express. Piensa en ello como una cadena de montaje donde cada middleware es una estaciÃ³n.

#### 2. **Ejemplo:**

```javascript
app.use((req, res, next) => {
  console.log('Time:', Date.now());
  next();
});
```

**â†’** Imprime la hora en cada peticiÃ³n antes de continuar

ğŸ”´ **Fundamental**: No puedes usar Express sin entender middlewares. Es el Ã¡tomo sobre el que se construye TODA aplicaciÃ³n Express.

---

## B - Middleware de AplicaciÃ³n ğŸŸ¡

#### 1. **IntroducciÃ³n:**

Se aplica a todas las rutas de tu aplicaciÃ³n usando `app.use()` o `app.METHOD()`.

#### 2. **Ejemplo:**

```javascript
// Para TODAS las rutas
app.use((req, res, next) => {
  console.log('PeticiÃ³n recibida');
  next();
});

// Solo para /user/*
app.use('/user/:id', (req, res, next) => {
  console.log('Acceso a zona de usuarios');
  next();
});
```

ğŸŸ¡ **Importante**: Es la forma mÃ¡s comÃºn de aplicar middlewares globales como loggers o parsers.

---

## C - Sub-Stacks de Middleware ğŸ”µ

#### 1. **IntroducciÃ³n:**

Puedes encadenar varios middlewares especialistas para una misma ruta.

#### 2. **Ejemplo:**

```javascript
function logUrl(req, res, next) {
  console.log('URL:', req.originalUrl);
  next();
}

function logMethod(req, res, next) {
  console.log('Method:', req.method);
  next();
}

app.get('/user/:id', [logUrl, logMethod], (req, res) => {
  res.send('User Info');
});
```

ğŸ”µ **EspecÃ­fico**: Ãštil para organizar y reutilizar lÃ³gica, pero no lo usarÃ¡s en cada componente.

---

## D - Manejo de Errores ğŸ”´

#### 1. **IntroducciÃ³n:**

Middleware especial con **4 argumentos** `(err, req, res, next)` para atrapar errores.

#### 2. **Ejemplo:**

```javascript
app.use((err, req, res, next) => {
  console.error(err.stack);
  res.status(500).send('Â¡Algo se rompiÃ³!');
});
```

**â†’** Se ejecuta cuando algÃºn middleware llama `next(err)`

ğŸ”´ **Fundamental**: Toda aplicaciÃ³n robusta NECESITA un manejador de errores. Es tu red de seguridad.

---

## E - express.json() y express.static() ğŸŸ¡

#### 1. **IntroducciÃ³n:**

Middlewares incorporados en Express para tareas comunes.

#### 2. **Ejemplo:**

```javascript
// Parsear JSON del body
app.use(express.json());

// Servir archivos estÃ¡ticos
app.use(express.static('public'));
```

ğŸŸ¡ **Importante**: Indispensables para APIs (`express.json()`) y sitios web (`express.static()`).
